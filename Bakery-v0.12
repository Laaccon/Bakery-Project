#include <iostream>
#include <iomanip>
#include <fstream>
#include <vector>
#include <iterator>
#include <ctime>
using namespace std;

struct item{
  string name;
  float price;
  float cost;
};

//Function Prototypes
void report();
void changeItems(vector<item> &);
void salesdata();
void addItem(vector<item> &);
float calculateCost();
void writeItems(vector<item> );
void readItems();
void displayMenu(vector<item>);

//Price of ingredients per gram as Global variables
float const flourprc = 0.0005f;
float const sugarprc = 0.001f;
float const chocoprc = 0.015f;
float const meatprc = 0.01f;
float const onionprc = 0.005f;
float const cheeseprc = 0.015f;


int main() {

  srand(time(NULL));
  
  //if there is no file create bakeryitems vector with default values
  vector<item> bakeryitems{
      {"BBQ Pork Bun", 3.5f, 0.94f}, 
      {"Onion Bread", 2.5f, 0.23f}, 
      {"Pizza Bun", 3.5f, 0.76f}, 
      {"Chocolate Bun", 2.5f, 0.35f}, 
      {"Cookie", 1.5f, 0.26f}};

  writeItems(bakeryitems);
  //Sales data
  vector<int> bakerysales{1235, 574, 870, 407, 712};

  float history[5][12];
  for(int row = 0; row < 5; row++){
    for(int col = 0; col < 12; col++){
      history[row][col] = rand() % 2000 + 120;
    }
  }


  int choice;
  do{
    
    //start user menu
    cout << "Choose an option from the menu: \n";
    cout << "-------------------------------\n";
    cout << "1. Access Sales Data\n";
    cout << "2. Change Sale Items\n";
    cout << "3. View history\n";
    cout << "\tEnter -1 to quit\n";
    cin >> choice;

    switch(choice){
      case 1 : salesdata(); break;
      case 2 : changeItems(bakeryitems); break;
      case 3 : for(int row = 0; row < 5; row++){
                for(int col = 0; col < 12; col++){
                  cout << history[row][col] << setw(5); 
                }
                cout << endl;
              } break;
      case -1: break;
      default : cout << "Bad Input. Try Again\n";
    }

  }while (choice >= 0);

  cout << "Good bye.";
}

/************************************************
* Purpose: Menu from which the user can select
*          adding or deleteing items from menu
* Input: vector of items
*************************************************/
void changeItems(vector<item> &items){
  int pick;
  vector<float> temp;
  cout << "We currently offer: \n";
 // Display Item with price  
  displayMenu(items);
  do{
    cout << "What would you like to do?\n";
    cout << "1. Add an item\n";
    cout << "2. Remove an item \n";
    cout << "3. Show Item list again\n";
    //cout << "4. Show Cost of each item\n";
    cout << "Enter -1 to go back\n";
    cin >> pick;

    switch (pick){
      case 1 : addItem(items);break;
      case 2 : ;
      case 3 : // Display Item with price  
                displayMenu(items);
                  cout << endl; break;
      //case 4 : temp = calculateCost(items); cout << endl; break;
      default : ;
    } 
  }while(pick >= 0);
}

/************************************************
* 
*
*************************************************/
void report(){
  cout << setw(10) << "Item:" << setw(7)<< "Price" << setw(7) << "Profit"; 
}

/************************************************
* 
*
*************************************************/
void salesdata(){

}

/************************************************
* Purpose: Add item to vector
* Input: vector of items
*************************************************/
void addItem(vector<item> &vec){
  string name;
  float price;
  float cost;
   
  cout << "Enter the name of the item:\n";
  cin >> name;
  cout << "Enter the price of the item\n";
  cin >> price;

  cost = calculateCost();
  item newItem = {name, price, cost};
  vec.push_back(newItem);
  writeItems(vec);

}

float calculateCost(){
  int flr,sgr,choc,meat,onion,chs;
  float total = 0.0;
  cout << "Enter how much flour is used:\n";
  cin >> flr;
  cout << "Enter how much sugar is used:\n";
  cin >> sgr;
  cout << "Enter how much chocolate is used:\n";
  cin >> choc;
  cout << "Enter how much meat is used:\n";
  cin >> meat;
  cout << "Enter how much onion is used:\n";
  cin >> onion;
  cout << "Enter how much cheese is used:\n";
  cin >> chs;
  
  total += flr * flourprc;
  total += sgr * sugarprc;
  total += choc * chocoprc;
  total += meat * meatprc;
  total += onion * onionprc;
  total += chs * cheeseprc;

  return total;
}

void writeItems(vector<item> vec){
  fstream output_file;
  output_file.open("items.txt");
    for(int i = 0; i < vec.size(); i++) {
    output_file << vec[i].name << "\t"<< vec[i].price <<"\t" << vec[i].cost << "\n";
    cout << vec[i].name<< endl;
  }
  output_file.close();
}

void readItems(){
  fstream input_file;
  input_file.open("items.txt");
  while (!input_file.eof() && input_file.is_open()) {
		cout << endl;
	}
	input_file.close();
}

item parseItem(ifstream &source){
  item fileItem;

  string name;
  float price;
  float cost;

	//Scanning a line from the file
	source >> name >> price >> cost;

	//Assigning the data to the tempCost variable
	fileItem.name = name;
  fileItem.price = price;
  fileItem.cost = cost;

	return fileItem;
}


void displayMenu(vector <item>  vec){
  cout << setw(20) << left <<"Item Name" <<fixed << setprecision(2) << setw(20) << right << "Price" << setw(7) << "Cost" << endl;
  cout <<"----------------------------------------------------\n";
  for(int i = 0; i < vec.size(); i++){
    cout << setw(20) << left << vec[i].name;
    cout << fixed << setprecision(2) << setw(20) << right << "$ "<< vec[i].price << setw(7) << vec[i].cost << endl;
  }
}
